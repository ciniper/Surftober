<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Surftober Web (Demo)</title>
  <link rel="manifest" href="./manifest.webmanifest">
  <link rel="stylesheet" href="./styles.css" />
  <meta name="theme-color" content="#0b3d91" />
</head>
<body>
  <header class="app-header">
    <div class="brand">üèÑ Surftober</div>
    <nav class="tabs">
      <a href="#log" class="tab-link" data-tab="log">Log</a>
      <a href="#me" class="tab-link" data-tab="me">My Stats</a>
      <a href="#leaderboard" class="tab-link" data-tab="leaderboard">Leaderboard</a>
      <a href="#awards" class="tab-link" data-tab="awards">Awards</a>
      <a href="#admin" id="tab-admin-link" class="tab-link" data-tab="admin">Admin</a>
      <a href="#account" class="tab-link" data-tab="account">Account</a>
    </nav>
  </header>

  <main id="app">
    <!-- Log Page -->
    <section id="page-log" class="page">
      <h2>Quick Log</h2>
      <form id="log-form">
        <div class="grid">
          <label>
            Name
            <input required list="user-list" id="log-user" placeholder="Your name" />
            <datalist id="user-list"></datalist>
          </label>
          <label>
            Date
            <input required type="date" id="log-date" />
          </label>
          <label>
            Type
            <select id="log-type">
              <option value="surf">Surf</option>
              <option value="windsport">Windsport (Kite/Wing)</option>
              <option value="swim">Swim/Dip/Bodysurf</option>
              <option value="other">Other (Kayak/In-water Photo/Boogie)</option>
              <option value="cleanup">Cleanup</option>
            </select>
          </label>
          <label>
            Duration
            <div class="duration-inputs">
              <input type="number" id="log-duration-h" min="0" max="24" value="1" aria-label="Hours" /> h
              <input type="number" id="log-duration-m" min="0" max="59" step="1" value="0" aria-label="Minutes" /> m
            </div>
          </label>
          <label>
            Location
            <input list="location-list" id="log-location" placeholder="e.g., OB - Lawton" />
            <datalist id="location-list"></datalist>
          </label>
          <label id="field-craft">
            Surf craft
            <input list="board-list" id="log-board" placeholder="e.g., 6'1 Phantom" />
            <datalist id="board-list"></datalist>
          </label>
        </div>
        <div class="grid">
          <label class="checkbox">
            <input type="checkbox" id="log-no-wetsuit" /> No Wetsuit (double minutes)
          </label>
          <label class="checkbox">
            <input type="checkbox" id="log-costume" /> Costume Bonus (+1h once)
          </label>
        </div>
        <label>
          Notes
          <textarea id="log-notes" rows="3" placeholder="Short journal‚Ä¶"></textarea>
        </label>
        <div class="actions">
          <button type="submit" id="btn-submit">Add Entry</button>
          <button type="button" id="btn-repeat-last">Repeat Last Settings</button>
          <button type="button" id="btn-cancel-edit" class="warn" style="display:none">Cancel Edit</button>
        </div>
      </form>

      <h3>Recent Entries</h3>
      <div id="recent-entries" class="card-list"></div>
    </section>

    <!-- My Stats Page -->
    <section id="page-me" class="page">
      <h2>My Stats</h2>
      <div class="filters">
        <label> Name
          <input list="user-list" id="me-user" placeholder="Your name" />
        </label>
        <label> Year
          <input type="number" id="me-year" value="2025" />
        </label>
        <label> Month
          <select id="me-month">
            <option value="10" selected>October (Surftober)</option>
            <option value="0">All Months</option>
          </select>
        </label>
      </div>
      <div id="me-summary" class="cards"></div>
      <h3>Sessions</h3>
      <div id="me-sessions" class="table"></div>
    </section>

    <!-- Leaderboard Page -->
    <section id="page-leaderboard" class="page">
      <h2>Leaderboard</h2>
      <div class="filters">
        <label> Year <input type="number" id="lb-year" value="2025" /></label>
        <label> Month
          <select id="lb-month">
            <option value="10" selected>October</option>
            <option value="0">All</option>
          </select>
        </label>
      </div>
      <div id="leaderboard" class="table"></div>
      <p class="hint">Medal thresholds (demo): Gold ‚â• 40h, Silver ‚â• 30h, Bronze ‚â• 25h, Participant ‚â• 10h.</p>
    </section>

    <!-- Awards Page -->
    <section id="page-awards" class="page">
      <h2>Awards</h2>
      <div class="filters">
        <label> Year <input type="number" id="aw-year" value="2025" /></label>
        <label> Month
          <select id="aw-month">
            <option value="10" selected>October</option>
            <option value="0">All</option>
          </select>
        </label>
        <button id="btn-compute-awards">Compute Awards</button>
        <button id="btn-export-awards">Export JSON</button>
        <button id="btn-awards-slides">Open Print Slides</button>
      </div>
      <div id="awards" class="cards"></div>
    </section>

    <!-- Admin Page -->
    <section id="page-admin" class="page">
      <h2>Admin</h2>
      <div class="cards">
        <div class="card">
          <h3>Import CSV</h3>
          <p>Columns (header expected): user,date(YYYY-MM-DD),type,duration(HH:MM),location,board,notes,no_wetsuit(0/1),costume(0/1),cleanup_items(int)</p>
          <input type="file" id="csv-file" accept=".csv,text/csv" />
        </div>
        <div class="card">
          <h3>Export</h3>
          <button id="btn-export-csv">Export Sessions CSV</button>
        </div>
        <div class="card">
          <h3>Seed Data (local demo only)</h3>
          <button id="btn-load-sample">Load Sample Dataset</button>
          <button id="btn-clear">Clear All Data</button>
        </div>
        <div class="card">
          <h3>Factory Reset</h3>
          <p>Signs out, clears local data and caches, and reloads.</p>
          <button id="btn-factory-reset" class="warn">Factory Reset (This device)</button>
        <div class="card" id="admin-users-card">
          <h3>Registered Users</h3>
          <p>Admins only ‚Äî list of emails and display names.</p>
          <div class="actions">
            <button id="btn-list-users">List Users</button>
          </div>
          <div id="admin-users" class="table"></div>
        </div>

        </div>
        <div class="card">
          <h3>Nuclear Wipe</h3>
          <p>Deletes ALL users and ALL logged data for this project. Requires the backend Edge Function to be deployed. This cannot be undone.</p>
          <button id="btn-nuclear-wipe" class="warn">Nuclear Wipe (All users + data)</button>
        </div>
        <div class="card">
          <h3>Status</h3>
          <pre id="status"></pre>
        </div>
      </div>
    </section>

    <!-- Account Page -->
    <section id="page-account" class="page">
      <h2>Account</h2>
      <div class="cards">
        <div class="card">
          <h3>Sign in</h3>
          <p>Use your email to receive a magic link.</p>
          <div class="grid">
            <label>Email
              <input type="email" id="auth-email" placeholder="you@example.com" />
            </label>
          </div>
          <div class="actions">
            <button id="btn-magic-link">Send Magic Link</button>
            <button id="btn-google">Sign in with Google</button>
            <button id="btn-signout" class="warn">Sign out</button>
          </div>
          <div class="hint" id="account-status"></div>
        </div>
        <div class="card">
          <h3>Profile</h3>
          <div class="grid">
            <label>Display name
              <input type="text" id="display-name" placeholder="Your public name" />
            </label>
          </div>
          <div class="actions">
            <button id="btn-save-name">Save Name</button>
            <button id="btn-delete-cloud" class="warn">Delete My Cloud Data</button>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer class="app-footer">
    <span>Surftober Demo ¬∑ PWA-ready <span id="live-status" class="live" style="display:none">‚Ä¢ LIVE</span></span>
    <span id="sw-status"></span>
  </footer>

  <div class="toast-container" id="toast-container" aria-live="polite"></div>

  <script src="./awards.js"></script>
  <script src="./app.js"></script>
</body>
</html>
